(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[625],{2789:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/basic/2.1-architecture",function(){return i(5625)}])},5625:function(e,n,i){"use strict";i.r(n),i.d(n,{__toc:function(){return b},default:function(){return u}});var r=i(5893),s=i(2673),c=i(373),t=i(8426);i(9128);var l=i(2643),d={src:"/docs-spring-batch/_next/static/media/2.1-infrastructure.be33beee.png",height:590,width:1063,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAAAAACWpiEsAAAAI0lEQVR42hXBiREAAAQDsO6/ME4fJ0GehqDk3Sr0/mnYRSc5N1wfeqjQ20cAAAAASUVORK5CYII=",blurWidth:8,blurHeight:4},a={src:"/docs-spring-batch/_next/static/media/2.2-schema-directory-1.0903495e.png",height:610,width:999,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAZElEQVR42h3G0RECIQwFwJAEkCvPGauxw+sHziPJi6Nfu+X9fHXCZ9u5c1MSsveWgBrALIT74AwEJfx25qJn+Ggtqj6Yh1kE1nWJsB5Eo2T+qioCoNY619IkQlL+cfc51zYD8AUBSUNxZjW4pAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5},h={src:"/docs-spring-batch/_next/static/media/2.2-schema-directory-2.02c4c1ce.png",height:711,width:1007,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAIAAABxZ0isAAAAkElEQVR42iWLSw7CIBRFWVfth1qrD/CBiK0FHDjQ1NSakNSBTow7cMsSTW7u4JwcMhn71DZwUyz1rN5WbAOyodCQtr2G2+vzDsN4F/YxDue+v9RmIoxR79anozaYSZYgZAipYglRuEIovNu7TitRKVHGSTH/i9Rbc3BGchppfI0LwqFElnu36xpEyH8Flbz8Agd1LeqMNRlyAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:6},o={src:"/docs-spring-batch/_next/static/media/2.2-schema-directory-3.3a3eb68a.png",height:1153,width:1002,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAICAIAAAC6ZnJRAAAAfUlEQVR42h3NOw4CMRADUHuyZKGhgENwHRok7l8jtFohRJL5MIobP7kx74/n6K2Zr4AjAlm++O9dx/d2uSoPum+b6U6KR1RKAK9SPmRxTwvJQEyxHk8JpFWVYCo8zDRBUmIexLzqvc9VFsxkVVAABcxNUo3sgfPoK6WJCPAHPR1Bs3RianEAAAAASUVORK5CYII=",blurWidth:7,blurHeight:8},x={src:"/docs-spring-batch/_next/static/media/2.3-job-instance-1.c30e9cc2.png",height:182,width:265,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAe0lEQVR42g3EWQ6CMBRA0e5/Tw7RP4nVtil2CIM/ItIw9PVFFAL05uSSPoxnVh5v5sSyw1XvknRPrRuQBMR7ai/sEXGVR8Wr8fgl0zx3Xes+tWvqAP7/G9fYshBAtFmujVFacyHiq+oNAMRDkPYpTEmlodJyXSRCtf2wAbHRad1jMm48AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5},j={src:"/docs-spring-batch/_next/static/media/2.5-step-execution-execution-context.c97ef52c.png",height:781,width:363,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAICAIAAABRUclSAAAAY0lEQVR42hXHSQ6DMAwAQP//bb21l7asAgcHscWAg4EogDSXgbyi1/v7+ZfUTTBOjmzb9QPPC+xHoN7d9DhhFfmleWVov6OqjTHsXIwRNtUakZlDCE8Q0Vr7RLxPizLJChF/AQLsWUfuzz+SAAAAAElFTkSuQmCC",blurWidth:4,blurHeight:8};let b=[{depth:2,value:"기본 구조",id:"기본-구조"},{depth:2,value:"JobLauncher, JobRepository, Job, Chunk, Tasklet,  ItemReader, ItemProcessor, ItemWriter",id:"joblauncher-jobrepository-job-chunk-tasklet--itemreader-itemprocessor-itemwriter"},{depth:3,value:"JobLauncher",id:"joblauncher"},{depth:3,value:"JobRepository",id:"jobrepository"},{depth:3,value:"Job",id:"job"},{depth:3,value:"Chunk, Tasklet",id:"chunk-tasklet"},{depth:3,value:"ItemReader, ItemProcessor, ItemWriter",id:"itemreader-itemprocessor-itemwriter"},{depth:2,value:"Sprng Batch Tables",id:"sprng-batch-tables"},{depth:3,value:"Table 명세",id:"table-명세"},{depth:3,value:"Schema 스크립트 경로",id:"schema-스크립트-경로"},{depth:3,value:"batch table 초기화 옵션",id:"batch-table-초기화-옵션"},{depth:3,value:"객체 매핑",id:"객체-매핑"},{depth:2,value:"JobInstance, JobParameters, JobExecution",id:"jobinstance-jobparameters-jobexecution"},{depth:2,value:"RunIdIncmenter",id:"runidincmenter"},{depth:2,value:"StepExecution, ExecutionContext",id:"stepexecution-executioncontext"},{depth:2,value:"요약",id:"요약"},{depth:2,value:"ExecutionContext",id:"executioncontext"}];function _createMdxContent(e){let n=Object.assign({h2:"h2",p:"p",a:"a",img:"img",h3:"h3",ul:"ul",li:"li",code:"code",strong:"strong",blockquote:"blockquote",pre:"pre",span:"span"},(0,l.a)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"기본-구조",children:"기본 구조"}),"\n",(0,r.jsxs)(n.p,{children:["참고 : ",(0,r.jsx)(n.a,{href:"https://docs.spring.io/spring-batch/docs/4.3.5/reference/html/job.html",children:"https://docs.spring.io/spring-batch/docs/4.3.5/reference/html/job.html"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://docs.spring.io/spring-batch/docs/4.3.5/reference/html/images/spring-batch-reference-model.png",alt:""})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h2,{id:"joblauncher-jobrepository-job-chunk-tasklet--itemreader-itemprocessor-itemwriter",children:"JobLauncher, JobRepository, Job, Chunk, Tasklet,  ItemReader, ItemProcessor, ItemWriter"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{placeholder:"blur",src:d})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"joblauncher",children:"JobLauncher"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Bean 을 생성만 했을 뿐인데 Batch가 실행될 수 있는데, 원하지 않는 잡들이 실행되는 것을 막으려면 application.yml 에 아래의 설정을 추가하면 됩니다.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"spring.batch.job.enabled: ${spring.batch.job.names:NONE}"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"spring.batch.job.names: ${job.name.NONE}"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Spring Batch 는 Job 타임에 Bean 이 생성되면 JobLauncher 객체에 의해서 Job 을 수행합니다."}),"\n",(0,r.jsx)(n.li,{children:"JobLauncher 는 Job 을 실행하고, Job 은 Step 을 수행합니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"jobrepository",children:"JobRepository"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"DB or Memory 에 스프링 배치가 실행될 수 있도록 배치의 메타데이터를 관리하는 역할을 수행"}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"job",children:"Job"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"배치의 실행단위"})," (중요!!)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Job 은 JobLauncher 에 의해 실행됩니다."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Job 은 여러 개의 Step 을 실행하며, Flow 를 관리할 수 있습니다."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"e.g. Step A → on 조건 B → Step B"}),"\n",(0,r.jsx)(n.li,{children:"이렇게 여러개의 Step 을 Flow 로 실행하는 것을 Job Flow 라고 부릅니다."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"chunk-tasklet",children:"Chunk, Tasklet"}),"\n",(0,r.jsxs)(n.p,{children:["예를 들어 100만건의 데이터를 처리해야 하는 작업이 있다고 하자.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(n.p,{children:"만약 100만건의 데이터에 대해 원하는 작업을 할 때 컴퓨터 자원에 문제가 없다면?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tasklet 처리를 해도 무방합니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"만약 100만건의 데이터에 대해 원하는 작업을 할 때 컴퓨터 자원에 문제가 있다면?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Chunk 기반의 처리를 하는 것이 권장됩니다."}),"\n",(0,r.jsx)(n.li,{children:"1만건 Size 의 Chunk 를 만들어서 이 Chunk 를 페이징 기반의 처리를 하는 방식으로 전환한다면, 메모리가 부족해져서 프로그램이 멈추는 현상 등을 방지할 수 있습니다."}),"\n",(0,r.jsx)(n.li,{children:"뒤에서 정리하겠지만, 가급적이면 페이징 사이즈는 Chunk Size 와 동일하게 하는 것이 권장됩니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Tasklet 도 나눠서 처리하는 것을 수동으로 작성할 수 있지만 ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["대용량 데이터를 처리시에는 Chunk 기반 처리방식이 더 활용성이 높고 ItemReader, ItemProcessor, ItemWriter 등을 통해서 딱딱 떨어지게끔 처리하면서 중간에 어디까지 실행했는지에 대한 Context 를 저장하거나 이력을 보관할 수 있기에 가급적이면 Chunk 기반의 처리를 하도록 작성하는 것을 추천되는 편입니다.",(0,r.jsx)("br",{})]}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"itemreader-itemprocessor-itemwriter",children:"ItemReader, ItemProcessor, ItemWriter"}),"\n",(0,r.jsx)(n.p,{children:"ItemReader"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"배치 처리를 해야 하는 대상 객체를 읽어들이는 역할"}),"\n",(0,r.jsxs)(n.li,{children:["e.g. ",(0,r.jsx)(n.code,{children:"FlatFileItemReader"}),", ",(0,r.jsx)(n.code,{children:"JdbcPagingItemReader"}),", ",(0,r.jsx)(n.code,{children:"JpaPagingItemReader"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"ItemProcessor"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ItemReader 로부터 읽어들인 데이터를 ItemWriter 로 보내기 전에 Processing 또는 Filtering 작업을 수행하는 역할"}),"\n",(0,r.jsx)(n.li,{children:"null 을 리턴하면 그 데이터는 필터링 되어 ItemWriter 로는 전달되지 않습니다."}),"\n",(0,r.jsx)(n.li,{children:"ItemProcessor 는 Optional 이며, 생략가능하다. 즉, Step 구성시 ItemReader, ItemWriter 로만 구성하는 것도 가능합니다."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"ItemWriter"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ItemProcessor 로부터 전달된 객체를 이용해서 데이터를 저장하거나, 메시지큐에 데이터를 전송하는 등과 같은 Write 하는 역할을 담당합니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h2,{id:"sprng-batch-tables",children:"Sprng Batch Tables"}),"\n",(0,r.jsx)(n.h3,{id:"table-명세",children:"Table 명세"}),"\n",(0,r.jsxs)(n.p,{children:["Spring Batch 는 배치 실행 기록과, 배치 실행 결과를 저장하는 테이블들을 가지고 있습니다. 이 테이블들을 Meta 테이블이라고 흔히 이야기합니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["참고 : ",(0,r.jsx)(n.a,{href:"https://docs.spring.io/spring-batch/reference/_images/meta-data-erd.png",children:"https://docs.spring.io/spring-batch/reference/_images/meta-data-erd.png"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://docs.spring.io/spring-batch/reference/_images/meta-data-erd.png",alt:""})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"BATCH_JOB_INSTANCE"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["위의 ERD 에서 BATCH_JOB_INSTANCE 테이블을 자세히 보면 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"})," 이 보입니다."]}),"\n",(0,r.jsxs)(n.li,{children:["배치 실행 시에는 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"})," 를 기준으로 하나의 row 가 생성되는데, 이 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"})," 는 중복을 허용하지 않습니다."]}),"\n",(0,r.jsxs)(n.li,{children:["즉, JobInstance 의 생성기준, BATCH_JOB_INSTANCE 테이블의 로우(ROW) 생성기준은 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"}),"이며 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"}),"은 중복되면 안됩니다."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"JOB_KEY"})," 값은 BATCH_JOB_EXECUTION_PARAMS 테이블 내에 저장되는 Parameter 를 나열해서 암호화해서 저장합니다."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"BATCH_JOB_EXECUTION_PARAMS"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Job 을 실행할 때 사용된(주입된) Parameter를 저장하는 테이블입니다."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"BATCH_JOB_EXECUTION"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Job 의 시작시각, Job의 종료시각, Job 의 상태 를 기록하기 위한 테이블입니다."}),"\n",(0,r.jsx)(n.li,{children:"Job 이 실행되는 시점에 BATCH_JOB_EXECUTION 테이블에 데이터가 추가됩니다."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"BATCH_JOB_EXECUTION_CONTEXT"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Job 이 실행되는 동안 공유되어야 하는 데이터를 직렬화 해서 저장합니다."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"BATCH_STEP_EXECUTION"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Step 이 실행되는 동안 필요한 데이터와 실행 결과를 저장합니다."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"BATCH_STEP_EXECUTION_CONTEXT"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Step 이 실행되는 동안 공유되어야 하는 데이터를 직렬화해서 저장합니다."}),"\n",(0,r.jsx)(n.li,{children:"이 테이블에서는 하나의 Step 이 실행되는 동안 데이터를 공유합니다."}),"\n",(0,r.jsx)(n.li,{children:"이 테이블에서는 Step 간에 테이블의 데이터를 공유하지 않으며, Step 간에 데이터를 공유하는 것은 BATCH_JOB_EXECUTION_CONTEXT 에서 데이터를 공유할 수 있습니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"schema-스크립트-경로",children:"Schema 스크립트 경로"}),"\n",(0,r.jsxs)(n.p,{children:["테이블 ddl 이 있는 곳의 경로는 ",(0,r.jsx)(n.code,{children:"spring-batch-core/org.springframework/batch/core*"})," 입니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["intellij 에서는 아래와 같이 찾으실 수 있습니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["Project View > External Libraries 에서 ",(0,r.jsx)(n.code,{children:"spring-batch-core"})," 를 검색합니다."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{placeholder:"blur",src:a})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.p,{children:["검색결과로 ",(0,r.jsx)(n.code,{children:"spring-batch-core-a.b.c.jar"})," 파일이 검색되었음을 확인 가능합니다."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{placeholder:"blur",src:h})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.p,{children:["스크롤을 내려보면 아래 그림처럼 ",(0,r.jsx)(n.code,{children:"schema-{db 타입}.sql"})," 파일들이 나타나는 것을 볼 수 있습니다."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{placeholder:"blur",src:o})}),"\n",(0,r.jsxs)(n.p,{children:["위와 같이 Spring Batch 팀에서는 Spring Batch 라이브러리에 필요한 스키마들을 class path 내에서 찾을 수 있도록 제공해주고 있습니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(n.h3,{id:"batch-table-초기화-옵션",children:"batch table 초기화 옵션"}),"\n",(0,r.jsx)(n.p,{children:"batch 테이블 초기화 옵션은 application.yml 파일에 아래와 같이 설정할 수 있습니다."}),"\n",(0,r.jsx)(n.pre,{"data-language":"yaml","data-theme":"default",children:(0,r.jsxs)(n.code,{"data-language":"yaml","data-theme":"default",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"spring"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"batch"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"initialize-schema"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"never"})]})]})}),"\n",(0,r.jsx)(n.p,{children:"이 속성에는 아래와 같은 값들을 지정 가능합니다."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spring.batch.initialize-schema=never"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"배치 잡 기동시 스키마 초기화 스크립트를 실행하지 않는 방식입니다."}),"\n",(0,r.jsx)(n.li,{children:"주로 Production 레벨에서 사용하는 옵션입니다."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spring.batch.initialize-schema=always"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"배치 잡 기동시 스키마 초기화 스크립트를 항상 수행하도록 지정하는 방식입니다."}),"\n",(0,r.jsx)(n.li,{children:"주로 개발환경에서 사용하는 옵션입니다."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"spring.batch.initialize-schema=embedded"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"배치 잡 기동시 스키마 초기화 스크립트를 h2 와 같은 embedded (내장) Database 를 사용할 때에만 사용할 수 있도록 지정하는 방식입니다."}),"\n",(0,r.jsx)(n.li,{children:"주로 개발환경에서 사용하는 옵션입니다."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h3,{id:"객체-매핑",children:"객체 매핑"}),"\n",(0,r.jsxs)(n.p,{children:["참고 : ",(0,r.jsx)(n.a,{href:"https://terasoluna-batch.github.io/guideline/5.0.0.RELEASE/en/Ch02_SpringBatchArchitecture.html#Ch02_SpringBatchArch_Detail_ProcessFlow",children:"https://terasoluna-batch.github.io/guideline/5.0.0.RELEASE/en/Ch02_SpringBatchArchitecture.html#Ch02_SpringBatchArch_Detail_ProcessFlow"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://terasoluna-batch.github.io/guideline/5.0.0.RELEASE/en/images/ch02/SpringBatchArchitecture/Ch02_SpringBatchArchitecture_Architecture_LaunchFlow.png",alt:""})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"JobInstance 객체 : BATCH_JOB_INSTANCE 테이블에 매핑"}),"\n",(0,r.jsx)(n.li,{children:"JobExecution 객체 : BATCH_JOB_EXECUTION 테이블에 매핑"}),"\n",(0,r.jsx)(n.li,{children:"JobParameters 객체 : BATCH_JOB_EXECUTION_PARAMS 테이블에 매핑"}),"\n",(0,r.jsx)(n.li,{children:"ExecutionContext 객체 : BATCH_JOB_EXECUTION_CONTEXT 테이블에 매핑"}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h2,{id:"jobinstance-jobparameters-jobexecution",children:"JobInstance, JobParameters, JobExecution"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{placeholder:"blur",src:x})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JobInstance"}),(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["JobInstance 는 BATCH_JOB_INSTANCE 테이블과 매핑되는 테이블입니다. JOB_INSTANCE 테이블의 주요 컬럼으로는 JOB_NAME, JOB_KEY 가 있습니다. 그리고 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"})," 를 기준으로 하나의 row 가 생성되는데, 이 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"})," 는 중복을 허용하지 않습니다. ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["즉, JobInstance 의 생성기준, BATCH_JOB_INSTANCE 테이블의 로우(ROW) 생성기준은 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"}),"이며 ",(0,r.jsx)(n.code,{children:"JOB_NAME"}),", ",(0,r.jsx)(n.code,{children:"JOB_KEY"}),"은 중복되면 안됩니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JobParameter, JobExecution"}),(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["JobInstance 를 새로 생성할지에 대한 기준은 JobParameter 의 중복 여부로 결정합니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["같은 Parameter 로 Job을 다시 실행하면 이미 생성된 JobInstance 를 실행합니다.",(0,r.jsx)("br",{})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["다른 Parameter 로 Job을 다시 실행하면 새로운 JobInstance 를 실행합니다.",(0,r.jsx)("br",{})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(n.p,{children:["JobExecution 은 JobInstance 재실행 여부와 상관 없이 항상 새롭게 생성됩니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(n.p,{children:"e.g."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Job 실행시 12월 1일 이라는 date parameter 를 처음 받아서 실행했다면?","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"job_instance_id = k 에 해당하는 신규 JobInstance 실행"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Job 실행시 12월 2일 이라는 date parameter 를 처음 받아서 실행했다면?","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"job_instance_id = m 에 해당하는 신규 JobInstance 실행"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Job 실행시 12월 2일 이라는 date parameter 를  한번 더 받아서 실행했다면?","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"job_instance_id = m 에 해당하는 JobInstance 를 재실행"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h2,{id:"runidincmenter",children:"RunIdIncmenter"}),"\n",(0,r.jsxs)(n.p,{children:["Job 을 항상 새로운 JobInstance로 실행되게끔 해야 할 경우가 있습니다. ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["이런 경우 RunIdIncrementer 를 사용합니다. ",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["RunIdIncrementer 를 사용하면 ",(0,r.jsx)(n.code,{children:"run.id"})," 라는  ",(0,r.jsx)(n.code,{children:"job_key"})," 에 대해 항상 다른 ",(0,r.jsx)(n.code,{children:"job_name"})," 값이 지정되어서 항상 새로운 JobInstance 로 실행됩니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h2,{id:"stepexecution-executioncontext",children:"StepExecution, ExecutionContext"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{placeholder:"blur",src:j})}),"\n",(0,r.jsx)(n.p,{children:"StepExecution : BATCH_STEP_EXECUTION 테이블에 매핑되는 객체"}),"\n",(0,r.jsx)(n.p,{children:"ExecutionContext : BATCH_STEP_EXECUTION_CONTEXT 테이블에 매핑되는 객체"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"JOB, STEP 에 모두 매핑될 수 있는 객체입니다."}),"\n",(0,r.jsx)(n.li,{children:"참고) BATCH_JOB_EXECUTION_CONTEXT 테이블은 ExecutionContext 객체와 매핑됩니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h2,{id:"요약",children:"요약"}),"\n",(0,r.jsxs)(n.p,{children:["하나의 Job 은 항상 같은 파라미터로 새롭게 실행하는 것은 불가능합니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.p,{children:["ExecutionContext 는 Job, Step 의 Context 를 관리하는 객체입니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ExecutionContext 를 통해서 데이터를 공유할 수 있습니다."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["JobExecutionContext",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Job 내에서만 데이터를 공유할 수 있습니다"}),"\n",(0,r.jsx)(n.li,{children:"JobExecutionContext 는 Step 끼리 데이터를 공유할 수 있습니다."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["StepExecutionContext",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Step 내에서만 데이터를 공유할 수 있습니다."}),"\n",(0,r.jsx)(n.li,{children:"Step 내에서만 공유하다는 의미이며, 다른 Step 과는 공유가 불가능합니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.h2,{id:"executioncontext",children:"ExecutionContext"}),"\n",(0,r.jsx)(n.p,{children:"Job 내에서 서로 다른 Step A, B 가 실행되게끔 Job 을 구성했다고 하겠습니다."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"TODO : 예제 추가 필요"}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"JobExecutionContext"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Job 내에서만 데이터를 공유할 수 있습니다"}),"\n",(0,r.jsx)(n.li,{children:"JobExecutionContext 는 Step 끼리 데이터를 공유할 수 있습니다."}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"StepExecutionContext"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Step 내에서만 데이터를 공유할 수 있습니다."}),"\n",(0,r.jsx)(n.li,{children:"Step 내에서만 공유하다는 의미이며, 다른 Step 과는 공유가 불가능합니다."}),"\n"]}),"\n",(0,r.jsx)("br",{})]})}let p={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,l.a)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/basic/2.1-architecture.mdx",route:"/basic/2.1-architecture",timestamp:1719182286e3,pageMap:[{kind:"Folder",name:"advanced",route:"/advanced",children:[{kind:"MdxPage",name:"chunk-oriented-tasklet--chunk-provider--chunk-processor",route:"/advanced/chunk-oriented-tasklet--chunk-provider--chunk-processor"},{kind:"MdxPage",name:"etc",route:"/advanced/etc"},{kind:"Meta",data:{"chunk-oriented-tasklet--chunk-provider--chunk-processor":" ChunkOrientedTasklet, ChunkProvider, ChunkProcessor",etc:"Etc"}}]},{kind:"MdxPage",name:"advanced",route:"/advanced"},{kind:"Folder",name:"basic",route:"/basic",children:[{kind:"MdxPage",name:"1-setting-hellobatch",route:"/basic/1-setting-hellobatch"},{kind:"MdxPage",name:"2.1-architecture",route:"/basic/2.1-architecture"},{kind:"MdxPage",name:"2.2-spring-batch-essential",route:"/basic/2.2-spring-batch-essential"},{kind:"MdxPage",name:"3-cursor-item-reader-vs-paging-item-reader",route:"/basic/3-cursor-item-reader-vs-paging-item-reader"},{kind:"MdxPage",name:"4-jdbc-batch-item-writer-vs-jpa-item-writer",route:"/basic/4-jdbc-batch-item-writer-vs-jpa-item-writer"},{kind:"MdxPage",name:"csv-read-write-example",route:"/basic/csv-read-write-example"},{kind:"MdxPage",name:"job-config-live-template-creation",route:"/basic/job-config-live-template-creation"},{kind:"Meta",data:{"1-setting-hellobatch":"Setting + Hello,Spring Batch","job-config-live-template-creation":"JobConfig Live Template 만들기","2.1-architecture":"기본 구조","2.2-spring-batch-essential":"Spring Batch Essential","csv-read-write-example":"CSV 파일 읽기/쓰기 예제","3-cursor-item-reader-vs-paging-item-reader":"CursorItemReader, PagingItemReader","4-jdbc-batch-item-writer-vs-jpa-item-writer":"JdbcBatchItemWriter vs JpaItemWriter"}}]},{kind:"MdxPage",name:"basic",route:"/basic"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"info",route:"/info"},{kind:"Folder",name:"todo",route:"/todo",children:[{kind:"MdxPage",name:"need-to-paging-based-processing",route:"/todo/need-to-paging-based-processing"},{kind:"Meta",data:{"need-to-paging-based-processing":"Need to Paging Based Processing"}}]},{kind:"MdxPage",name:"todo",route:"/todo"},{kind:"Meta",data:{index:"Introduction",basic:"Basic",advanced:"Advanced",todo:"Todo",etc:"기타 개념들",info:"자료모음",contact:{title:"Contact ↗",type:"page",href:"-",newWindow:!0}}}],flexsearch:{codeblocks:!0},title:"2.1 Architecture",headings:b},pageNextRoute:"/basic/2.1-architecture",nextraLayout:c.ZP,themeConfig:t.Z};var u=(0,s.j)(p)},8426:function(e,n,i){"use strict";var r=i(5893);i(7294);let s={logo:(0,r.jsx)("span",{children:"Docs Spring Batch"}),project:{link:"https://github.com/chagchagchag/docs-spring-batch"},docsRepositoryBase:"https://github.com/chagchagchag/docs-spring-batch",footer:{text:"Nextra Docs Template"}};n.Z=s},5789:function(){}},function(e){e.O(0,[774,796,888,179],function(){return e(e.s=2789)}),_N_E=e.O()}]);